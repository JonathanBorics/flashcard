{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jonathan/Desktop/flashcard/app/api/translate/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport path from \"path\";\r\nimport { promises as fs } from \"fs\";\r\n\r\nexport const dynamic = \"force-dynamic\";\r\n\r\n// =================================================================\r\n// Szolg√°ltat√≥i F√ºggv√©nyek\r\n// =================================================================\r\n\r\n// 1. SZOLG√ÅLTAT√ì: Helyi Mini-Sz√≥t√°r\r\nlet miniDictionary = null;\r\nasync function getFromLocalDictionary(word) {\r\n  try {\r\n    if (miniDictionary === null) {\r\n      const jsonPath = path.join(\r\n        process.cwd(),\r\n        \"public\",\r\n        \"data\",\r\n        \"mini_dictionary.json\"\r\n      );\r\n      const jsonData = await fs.readFile(jsonPath, \"utf-8\");\r\n      miniDictionary = JSON.parse(jsonData);\r\n    }\r\n    const result = miniDictionary[word.toLowerCase()];\r\n    return result || [];\r\n  } catch (error) {\r\n    miniDictionary = {};\r\n    return [];\r\n  }\r\n}\r\n\r\n// 2. SZOLG√ÅLTAT√ì: Deep-Translator (Google - gyors ford√≠t√°s)\r\nasync function getQuickTranslation(word) {\r\n  try {\r\n    const response = await fetch(\r\n      \"https://deep-translator-api.azurewebsites.net/google/\",\r\n      {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ source: \"auto\", target: \"hu\", text: word }),\r\n      }\r\n    );\r\n    if (!response.ok) return [];\r\n    const data = await response.json();\r\n    return data.translation ? [data.translation.toLowerCase()] : [];\r\n  } catch (error) {\r\n    return [];\r\n  }\r\n}\r\n\r\n// 3. SZOLG√ÅLTAT√ì: Deep-Translator (PONS - t√∂bb sz√≥t√°ri jelent√©s)\r\nasync function getDictionaryMeanings(word) {\r\n  try {\r\n    const response = await fetch(\r\n      \"https://deep-translator-api.azurewebsites.net/pons/\",\r\n      {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ source: \"en\", target: \"hu\", text: word }),\r\n      }\r\n    );\r\n    if (!response.ok) return [];\r\n    const data = await response.json();\r\n    return Array.isArray(data.translation)\r\n      ? data.translation.map((t) => t.toLowerCase())\r\n      : [];\r\n  } catch (error) {\r\n    return [];\r\n  }\r\n}\r\n\r\n// 4. SZOLG√ÅLTAT√ì: Dictionary API (CSAK v√©gs≈ë tartal√©k defin√≠ci√≥)\r\nasync function getEnglishDefinition(word) {\r\n  try {\r\n    const response = await fetch(\r\n      `https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(\r\n        word\r\n      )}`\r\n    );\r\n    if (!response.ok) return null;\r\n    const data = await response.json();\r\n    const definition = data[0]?.meanings?.[0]?.definitions?.[0]?.definition;\r\n    return definition ? `(def.) ${definition}` : null;\r\n  } catch (error) {\r\n    return null;\r\n  }\r\n}\r\n\r\n// =================================================================\r\n// F≈ë API Logika\r\n// =================================================================\r\nexport async function GET(request) {\r\n  const { searchParams } = new URL(request.url);\r\n  const word = searchParams.get(\"word\");\r\n\r\n  if (!word) {\r\n    return NextResponse.json({ error: 'A \"word\" param√©ter k√∂telez≈ë.' });\r\n  }\r\n\r\n  // 1. L√âP√âS: Keres√©s a helyi sz√≥t√°rban\r\n  let finalMeanings = await getFromLocalDictionary(word);\r\n\r\n  // 2. L√âP√âS: Ha nincs helyi tal√°lat, h√≠vjuk a k√ºls≈ë API-kat\r\n  if (finalMeanings.length === 0) {\r\n    const [quick, dictionary] = await Promise.all([\r\n      getQuickTranslation(word),\r\n      getDictionaryMeanings(word),\r\n    ]);\r\n\r\n    // √ñsszef√©s√ºlj√ºk a MAGYAR eredm√©nyeket\r\n    const combined = [...new Set([...quick, ...dictionary])];\r\n    finalMeanings = combined.filter(Boolean);\r\n  }\r\n\r\n  // 3. L√âP√âS: V√©gs≈ë tartal√©k, ha egyik magyar forr√°s sem m≈±k√∂d√∂tt\r\n  if (finalMeanings.length === 0) {\r\n    const definition = await getEnglishDefinition(word);\r\n    if (definition) {\r\n      finalMeanings.push(definition);\r\n    }\r\n  }\r\n\r\n  if (finalMeanings.length === 0) {\r\n    // A synonyms kulcsot √ºresen k√ºldj√ºk, hogy a UI ne jelen√≠tsen meg semmit\r\n    return NextResponse.json({\r\n      translation: [\"Nincs el√©rhet≈ë ford√≠t√°s\"],\r\n      synonyms: [],\r\n    });\r\n  }\r\n\r\n  // A synonyms kulcsot √ºresen k√ºldj√ºk\r\n  return NextResponse.json({ translation: finalMeanings, synonyms: [] });\r\n}\r\n// import { NextResponse } from 'next/server';\r\n// import path from 'path';\r\n// import { promises as fs } from 'fs';\r\n\r\n// export const dynamic = 'force-dynamic';\r\n\r\n// let superDictionary = null;\r\n// async function getFromLocalDictionary(word) {\r\n//   try {\r\n//     if (superDictionary === null) {\r\n//       console.log('üìö Szuper-sz√≥t√°r bet√∂lt√©se...');\r\n//       const jsonPath = path.join(process.cwd(), 'public', 'data', 'super_dictionary.json');\r\n//       const jsonData = await fs.readFile(jsonPath, 'utf-8');\r\n//       superDictionary = JSON.parse(jsonData);\r\n//       console.log('‚úÖ Szuper-sz√≥t√°r sikeresen bet√∂ltve.');\r\n//     }\r\n//     const result = superDictionary[word.toLowerCase()];\r\n//     return result || [];\r\n//   } catch (error) {\r\n//     console.error(`‚ùå Hiba a szuper-sz√≥t√°r olvas√°sakor: ${error.message}`);\r\n//     superDictionary = {};\r\n//     return [];\r\n//   }\r\n// }\r\n\r\n// // V√©gs≈ë tartal√©k angol defin√≠ci√≥\r\n// async function getEnglishDefinition(word) {\r\n//   try {\r\n//     const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(word)}`);\r\n//     if (!response.ok) return null;\r\n//     const data = await response.json();\r\n//     const definition = data[0]?.meanings?.[0]?.definitions?.[0]?.definition;\r\n//     return definition ? `(def.) ${definition}` : null;\r\n//   } catch (error) {\r\n//     return null;\r\n//   }\r\n// }\r\n\r\n// export async function GET(request) {\r\n//   const { searchParams } = new URL(request.url);\r\n//   const word = searchParams.get('word');\r\n\r\n//   if (!word) {\r\n//     return NextResponse.json({ translation: [], synonyms: [] });\r\n//   }\r\n\r\n//   // 1. L√âP√âS: Keres√©s a Szuper-sz√≥t√°rban\r\n//   let finalMeanings = await getFromLocalDictionary(word);\r\n\r\n//   // 2. L√âP√âS: V√©gs≈ë tartal√©k, ha a sz√≥ valami√©rt nincs a sz√≥t√°runkban\r\n//   if (finalMeanings.length === 0) {\r\n//     console.log(`‚ÄºÔ∏è '${word}' nincs a szuper-sz√≥t√°rban. Pr√≥b√°lkoz√°s angol defin√≠ci√≥val.`);\r\n//     const definition = await getEnglishDefinition(word);\r\n//     if (definition) {\r\n//       finalMeanings.push(definition);\r\n//     }\r\n//   }\r\n\r\n//   if (finalMeanings.length === 0) {\r\n//     return NextResponse.json({ translation: [\"Nincs el√©rhet≈ë ford√≠t√°s\"], synonyms: [] });\r\n//   }\r\n\r\n//   return NextResponse.json({ translation: finalMeanings, synonyms: [] });\r\n// }\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEO,MAAM,UAAU;AAEvB,oEAAoE;AACpE,0BAA0B;AAC1B,oEAAoE;AAEpE,oCAAoC;AACpC,IAAI,iBAAiB;AACrB,eAAe,uBAAuB,IAAI;IACxC,IAAI;QACF,IAAI,mBAAmB,MAAM;YAC3B,MAAM,WAAW,4GAAI,CAAC,IAAI,CACxB,QAAQ,GAAG,IACX,UACA,QACA;YAEF,MAAM,WAAW,MAAM,yGAAE,CAAC,QAAQ,CAAC,UAAU;YAC7C,iBAAiB,KAAK,KAAK,CAAC;QAC9B;QACA,MAAM,SAAS,cAAc,CAAC,KAAK,WAAW,GAAG;QACjD,OAAO,UAAU,EAAE;IACrB,EAAE,OAAO,OAAO;QACd,iBAAiB,CAAC;QAClB,OAAO,EAAE;IACX;AACF;AAEA,4DAA4D;AAC5D,eAAe,oBAAoB,IAAI;IACrC,IAAI;QACF,MAAM,WAAW,MAAM,MACrB,yDACA;YACE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,QAAQ;gBAAQ,QAAQ;gBAAM,MAAM;YAAK;QAClE;QAEF,IAAI,CAAC,SAAS,EAAE,EAAE,OAAO,EAAE;QAC3B,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,OAAO,KAAK,WAAW,GAAG;YAAC,KAAK,WAAW,CAAC,WAAW;SAAG,GAAG,EAAE;IACjE,EAAE,OAAO,OAAO;QACd,OAAO,EAAE;IACX;AACF;AAEA,iEAAiE;AACjE,eAAe,sBAAsB,IAAI;IACvC,IAAI;QACF,MAAM,WAAW,MAAM,MACrB,uDACA;YACE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,QAAQ;gBAAM,QAAQ;gBAAM,MAAM;YAAK;QAChE;QAEF,IAAI,CAAC,SAAS,EAAE,EAAE,OAAO,EAAE;QAC3B,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,OAAO,MAAM,OAAO,CAAC,KAAK,WAAW,IACjC,KAAK,WAAW,CAAC,GAAG,CAAC,CAAC,IAAM,EAAE,WAAW,MACzC,EAAE;IACR,EAAE,OAAO,OAAO;QACd,OAAO,EAAE;IACX;AACF;AAEA,iEAAiE;AACjE,eAAe,qBAAqB,IAAI;IACtC,IAAI;QACF,MAAM,WAAW,MAAM,MACrB,CAAC,gDAAgD,EAAE,mBACjD,OACC;QAEL,IAAI,CAAC,SAAS,EAAE,EAAE,OAAO;QACzB,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,aAAa,IAAI,CAAC,EAAE,EAAE,UAAU,CAAC,EAAE,EAAE,aAAa,CAAC,EAAE,EAAE;QAC7D,OAAO,aAAa,CAAC,OAAO,EAAE,YAAY,GAAG;IAC/C,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAKO,eAAe,IAAI,OAAO;IAC/B,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,OAAO,aAAa,GAAG,CAAC;IAE9B,IAAI,CAAC,MAAM;QACT,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA+B;IACnE;IAEA,sCAAsC;IACtC,IAAI,gBAAgB,MAAM,uBAAuB;IAEjD,2DAA2D;IAC3D,IAAI,cAAc,MAAM,KAAK,GAAG;QAC9B,MAAM,CAAC,OAAO,WAAW,GAAG,MAAM,QAAQ,GAAG,CAAC;YAC5C,oBAAoB;YACpB,sBAAsB;SACvB;QAED,sCAAsC;QACtC,MAAM,WAAW;eAAI,IAAI,IAAI;mBAAI;mBAAU;aAAW;SAAE;QACxD,gBAAgB,SAAS,MAAM,CAAC;IAClC;IAEA,gEAAgE;IAChE,IAAI,cAAc,MAAM,KAAK,GAAG;QAC9B,MAAM,aAAa,MAAM,qBAAqB;QAC9C,IAAI,YAAY;YACd,cAAc,IAAI,CAAC;QACrB;IACF;IAEA,IAAI,cAAc,MAAM,KAAK,GAAG;QAC9B,wEAAwE;QACxE,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,aAAa;gBAAC;aAA0B;YACxC,UAAU,EAAE;QACd;IACF;IAEA,oCAAoC;IACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,aAAa;QAAe,UAAU,EAAE;IAAC;AACtE,EACA,8CAA8C;CAC9C,2BAA2B;CAC3B,uCAAuC;CAEvC,0CAA0C;CAE1C,8BAA8B;CAC9B,gDAAgD;CAChD,UAAU;CACV,sCAAsC;CACtC,sDAAsD;CACtD,8FAA8F;CAC9F,+DAA+D;CAC/D,gDAAgD;CAChD,4DAA4D;CAC5D,QAAQ;CACR,0DAA0D;CAC1D,2BAA2B;CAC3B,sBAAsB;CACtB,6EAA6E;CAC7E,4BAA4B;CAC5B,iBAAiB;CACjB,MAAM;CACN,IAAI;CAEJ,oCAAoC;CACpC,8CAA8C;CAC9C,UAAU;CACV,mHAAmH;CACnH,qCAAqC;CACrC,0CAA0C;CAC1C,+EAA+E;CAC/E,yDAAyD;CACzD,sBAAsB;CACtB,mBAAmB;CACnB,MAAM;CACN,IAAI;CAEJ,uCAAuC;CACvC,mDAAmD;CACnD,2CAA2C;CAE3C,iBAAiB;CACjB,mEAAmE;CACnE,MAAM;CAEN,4CAA4C;CAC5C,4DAA4D;CAE5D,yEAAyE;CACzE,sCAAsC;CACtC,6FAA6F;CAC7F,2DAA2D;CAC3D,wBAAwB;CACxB,wCAAwC;CACxC,QAAQ;CACR,MAAM;CAEN,sCAAsC;CACtC,4FAA4F;CAC5F,MAAM;CAEN,4EAA4E;CAC5E,IAAI","debugId":null}}]
}