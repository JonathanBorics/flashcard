{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jonathan/Desktop/flashcard/app/api/translate/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { translate } from \"@vitalets/google-translate-api\";\r\n\r\nexport const dynamic = \"force-dynamic\";\r\n\r\n// =================================================================\r\n// Szolgáltatói Függvények (külön-külön, cserélhetően)\r\n// =================================================================\r\n\r\n// 1. SZOLGÁLTATÓ: LibreTranslate (Az új, elsődleges forrásunk)\r\nasync function getLibreTranslate(word) {\r\n  try {\r\n    const response = await fetch(\r\n      \"https://translate.argosopentech.com/translate\",\r\n      {\r\n        method: \"POST\",\r\n        body: JSON.stringify({\r\n          q: word,\r\n          source: \"en\",\r\n          target: \"hu\",\r\n        }),\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n      }\r\n    );\r\n    if (!response.ok) throw new Error(`Status: ${response.status}`);\r\n    const data = await response.json();\r\n    return data.translatedText ? [data.translatedText.toLowerCase()] : [];\r\n  } catch (error) {\r\n    console.warn(`⚠️ LibreTranslate API hiba: ${error.message}`);\r\n    return []; // Hiba esetén üres tömböt adunk vissza\r\n  }\r\n}\r\n\r\n// 2. SZOLGÁLTATÓ: Google Translate\r\nasync function getGoogleTranslate(word) {\r\n  try {\r\n    const { text } = await translate(word, { to: \"hu\" });\r\n    return text\r\n      .split(\",\")\r\n      .map((m) => m.trim().toLowerCase())\r\n      .filter(Boolean);\r\n  } catch (error) {\r\n    console.warn(`⚠️ Google Translate API hiba: ${error.message}`);\r\n    return [];\r\n  }\r\n}\r\n\r\n// 3. SZOLGÁLTATÓ: Glosbe\r\nasync function getGlosbeTranslations(word) {\r\n  try {\r\n    const url = `https://glosbe.com/gapi/translate?from=eng&dest=hun&format=json&phrase=${encodeURIComponent(\r\n      word\r\n    )}`;\r\n    const response = await fetch(url);\r\n    if (!response.ok) return [];\r\n    const data = await response.json();\r\n    return (\r\n      data.tuc\r\n        ?.map((item) => item.phrase?.text.toLowerCase())\r\n        .filter(Boolean)\r\n        .slice(0, 5) || []\r\n    );\r\n  } catch (error) {\r\n    console.warn(`⚠️ Glosbe API hiba: ${error.message}`);\r\n    return [];\r\n  }\r\n}\r\n\r\n// 4. SZOLGÁLTATÓ: Dictionary (Végső tartalék)\r\nasync function getDictionaryDefinitions(word) {\r\n  try {\r\n    const response = await fetch(\r\n      `https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(\r\n        word\r\n      )}`\r\n    );\r\n    if (!response.ok) return [];\r\n    const data = await response.json();\r\n    const definition = data[0]?.meanings?.[0]?.definitions?.[0]?.definition;\r\n    return definition ? [`(def.) ${definition}`] : [];\r\n  } catch (error) {\r\n    console.warn(`⚠️ Dictionary API hiba: ${error.message}`);\r\n    return [];\r\n  }\r\n}\r\n\r\n// =================================================================\r\n// Fő API Logika (a \"Vízesés\" Modell)\r\n// =================================================================\r\n\r\nexport async function GET(request) {\r\n  const { searchParams } = new URL(request.url);\r\n  const word = searchParams.get(\"word\");\r\n\r\n  if (!word) {\r\n    return NextResponse.json(\r\n      { error: 'A \"word\" paraméter kötelező.' },\r\n      { status: 400 }\r\n    );\r\n  }\r\n\r\n  let finalMeanings = [];\r\n\r\n  // Próbálkozási sorrend (a szolgáltatók lánca)\r\n  const providers = [\r\n    { name: \"LibreTranslate\", func: getLibreTranslate },\r\n    { name: \"GoogleTranslate\", func: getGoogleTranslate },\r\n    { name: \"Glosbe\", func: getGlosbeTranslations },\r\n  ];\r\n\r\n  // Megpróbáljuk a magyar fordítókat sorban\r\n  for (const provider of providers) {\r\n    const results = await provider.func(word);\r\n    if (results.length > 0) {\r\n      finalMeanings.push(...results);\r\n      console.log(\r\n        `✅ Sikeres találat a(z) ${provider.name} szolgáltatótól:`,\r\n        results\r\n      );\r\n    }\r\n  }\r\n\r\n  // A magyar eredmények összefésülése és tisztítása\r\n  finalMeanings = [...new Set(finalMeanings)].filter(Boolean);\r\n\r\n  // Végső Tartalék - CSAK HA EGYIK MAGYAR FORDÍTÓ SEM MŰKÖDÖTT\r\n  if (finalMeanings.length === 0) {\r\n    console.log(\r\n      \"‼️ Egyik magyar fordító sem működött. Végső próbálkozás angol definícióval.\"\r\n    );\r\n    const definitions = await getDictionaryDefinitions(word);\r\n    finalMeanings.push(...definitions);\r\n  }\r\n\r\n  // Ha végképp semmi nincs, akkor adjuk fel.\r\n  if (finalMeanings.length === 0) {\r\n    return NextResponse.json({ translation: [\"Nincs elérhető fordítás\"] });\r\n  }\r\n\r\n  return NextResponse.json({ translation: finalMeanings });\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}